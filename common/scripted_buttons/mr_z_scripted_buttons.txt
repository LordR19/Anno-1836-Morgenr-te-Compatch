#####################################
# MR ANNO COMPATCH SCRIPTED BUTTONS #
#####################################

######NORTHWEST EXPEDITION######

mr_northwest_expedition_button = {
	name = "mr_northwest_expedition_button"
	desc = "mr_northwest_expedition_button_desc"

	visible = { 
		NOT = {
			has_global_variable = rapanui_northwest_passage_found_var
		}
	}

	possible = {
		has_technology_researched = screw_frigate
		has_technology_researched = dialectics
		has_technology_researched = canneries
		any_scope_building = {
			is_building_type = building_port
		}
		any_scope_building = {
			is_building_type = building_university
		}
		navy_size >= 25
		any_scope_character = {
			has_role = admiral
			is_busy = no
		}
		OR = {
			ig:ig_armed_forces = {
				is_in_government = yes
			}
			ig:ig_industrialists = {
				is_in_government = yes
			}
			ig:ig_intelligentsia = {
				is_in_government = yes
			}
		}
		OR = {
			any_scope_interest_marker = {
				region = sr:region_ruperts_land
			}
			any_scope_interest_marker = {
				region = sr:region_pacific_coast
			}
			any_scope_interest_marker = {
				region = sr:region_north_sea_coast
			}
		}
		NOR = {
			has_modifier = rapanui_northwest_expedition_modifier
			has_modifier = rapanui_had_northwest_expedition_modifier
		}
	}

	effect = {
		add_treasury = -100000
		add_modifier = {
			name = rapanui_northwest_expedition_modifier
		}
		trigger_event = { 
			id = rapanui.401
			popup = yes
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
	}
}

######ARCTIC EXPEDITION######

mr_arctica_expedition_button = {
	name = "mr_arctica_expedition_button"
	desc = "mr_arctica_expedition_button_desc"

	visible = { always = yes }

	possible = {
		has_technology_researched = zeppelins
		any_scope_building = {
			is_building_type = building_verrier_observatory
			has_active_production_method = pm_curtiss_weather_station
		}
		any_scope_character = {
			OR = {
				has_trait = curtiss_pilot
				has_trait = curtiss_pilot_ace
			}
			is_busy = no
		}
		OR = {

			OR = {
				any_scope_state = {
					state_region = s:STATE_GREENLAND
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_GREENLAND
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_NORTHERN_NORWAY
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_NORTHERN_NORWAY
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_ALASKA
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_ALASKA
					}
				}		
			}
			OR = {
				any_scope_state = {
				state_region = s:STATE_NUNAVUT
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_NUNAVUT
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_ARKHANGELSK
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_ARKHANGELSK
					}
				}		
			}
		}
		NOR = {
			has_modifier = curtiss_arctica_expedition_modifier
			has_modifier = curtiss_had_arctica_expedition_modifier
		}
	}

	effect = {
		set_variable = {
			name = curtiss_zeppelin_progress
			value = 0
		}
		set_variable = {
			name = curtiss_zeppelin_science
			value = 0
		}
		set_variable = {
			name = curtiss_zeppelin_danger
			value = 0
		}
		add_modifier = {
			name = curtiss_arctica_expedition_modifier
		}
		add_modifier = {
			name = curtiss_zeppelin_expedition_cost_modifier
			multiplier = money_amount_multiplier_small
		}
		trigger_event = { 
			id = curtiss.520
			popup = yes 
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_small
				gold_reserves > 0

			}
			add = 1
		}
		modifier = {
			trigger = {
				has_strategy = ai_strategy_armed_isolationism
			}
			add = -1000
		}		
		modifier = {
			OR = {
				is_diplomatic_play_committed_participant = yes
				is_at_war = yes
			}
			add = -1000
		}
	}
}

###########################################################################

###Other special musical institutions###

mr_concertgebouw_button = {
	name = "mr_concertgebouw_button"
	desc = "mr_concertgebouw_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_HOLLAND
		}
		OR = {
			country_has_primary_culture = cu:wallonian
			country_has_primary_culture = cu:flemish
			country_has_primary_culture = cu:dutch
			country_has_primary_culture = cu:frisian
		}
		NOT = {
			any_state = {
				has_modifier = elgar_amsterdam_concertgebouw_modifier
			}
		}
	}

	possible = {
		any_scope_state = {
			state_region = s:STATE_HOLLAND
		}
		any_scope_building = {
			is_building_type = building_elgar_opera
			level >= 10
		}
		custom_tooltip = {
			text = elgar_concertgebouw_decision_tt
			var:elgar_music_tradition >= 750
		}
	}

	effect = {
		every_state = {
			limit = {
				state_region = s:STATE_HOLLAND
			}
			add_modifier = {
				name = elgar_amsterdam_concertgebouw_modifier
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}
