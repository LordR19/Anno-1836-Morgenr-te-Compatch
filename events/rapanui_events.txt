####################################
# MR ANNO COMPATCH RAPANUI EVENTS  #
####################################

#by Marco Dandolo

###################

namespace = rapanui

###################################################################################################################
#Updated Event List

#Imperialist Expedition Events
#Rapanui 240: Wallace Line
#Rapanui 255: Hostile Reaction
#Rapanui 257: Diplomatic Delegation

#Rapanui 433: National maritime disaster in $COUNTRY$

#Rapanui 240: Wallace Line

rapanui.240 = {
	dlc = dlc_morgenrote

	type = country_event

	title = rapanui.240.t
	desc = rapanui.240.d
	flavor = rapanui.240.f

	placement = scope:rapanui_pacific_expedition_location

	duration = 3

	gui_window = event_window_1char_tabloid

	left_icon = scope:rapanui_scientist

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	trigger = {
	}

	immediate = {
		set_global_variable = rapanui_wallace_line_found
		set_rapanui_expedition_leader_effect = yes
		set_rapanui_scientist_effect = yes
		random_state = {
			limit = {
				state_region = s:STATE_BALI
			}
			save_scope_as = rapanui_pacific_expedition_location
		}
	}

	option = {
		name = rapanui.240.g #A historical day
		default_option = yes
		dubois_add_x_specimen_effect = { AMOUNT = 10000 }
		dubois_large_add_technology = yes
		post_notification = rapanui_wallace_notification
		scope:rapanui_scientist = {
			set_variable = dubois_wallace_line_discovered_var
			add_modifier = {
				name = rapanui_russel_wallace_modifier
			}
		}
		naturalist_experience_gain_effect = {
			AMOUNT = "100"
		}
	}

	after = {
	}
}


#Rapanui 255: Hostile Reaction

rapanui.255 = {
	dlc = dlc_morgenrote

	type = country_event

	title = rapanui.255.t
	desc = rapanui.255.d
	flavor = rapanui.255.f

	placement = scope:rapanui_hostile_country

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/rapanui_pictures/rapanui_mission_failure.dds"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	cooldown = { 
		years = 1
	}

	trigger = {
		rapanui_has_imperialist_expedition = yes
		country_rank = rank_value:great_power
		has_variable = rapanui_pacific_expedition_location_indonesia
	}

	immediate = {
		set_rapanui_expedition_leader_effect = yes
		set_rapanui_scientist_effect = yes
		random_country = {
			limit = { 										#COMPATCH
				capital = {
					OR = {
						region = sr:region_malacca
						region = sr:region_java
						region = sr:region_makasser
						region = sr:region_moluccas
						region = sr:region_philippines					
					}
				}
			}
			save_scope_as = rapanui_hostile_country
		}
		ig:ig_armed_forces = {
			save_scope_as = army_ig
		}
	}

	option = {
		name = rapanui.255.g #A serious faux pas we should fix
		default_option = yes
		add_modifier = {
			name = lepsius_diplomatic_prostration_modifier
			years = 5
		}
	}

	option = {
		name = rapanui.255.h #Blame the commander
		scope:rapanui_hostile_country = {
			change_relations = {
				country = ROOT 
				value = -10
			}
		}
		scope:army_ig = {
			add_modifier = {
				name = lepsius_insulted_military_modifier
				years = 3
			}
		}
	}

	option = {
		name = rapanui.255.i #We don't apologize for anything
		change_infamy = 3
		scope:rapanui_hostile_country = {
			change_relations = {
				country = ROOT 
				value = -25
			}
		}
	}

	after = {
		add_rapanui_pacific_expedition_progress = yes
		sub_rapanui_pacific_expedition_reputation = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
		  has_variable = rapanui_pe_reputation_var
		  factor = 10
		}
	}
}

#Rapanui 257: Diplomatic Delegation

rapanui.257 = {
	dlc = dlc_morgenrote

	type = country_event

	title = rapanui.257.t
	desc = rapanui.257.d
	flavor = rapanui.257.f

	placement = scope:rapanui_friendly_country

	duration = 3

	event_image = {
		texture = "gfx/event_pictures/rapanui_pictures/rapanui_mission_failure.dds"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	cooldown = { 
		years = 1
	}

	trigger = {
		rapanui_has_imperialist_expedition = yes
		country_rank = rank_value:great_power
		has_variable = rapanui_pacific_expedition_location_indonesia
	}

	immediate = {
		set_rapanui_expedition_leader_effect = yes
		set_rapanui_scientist_effect = yes
		random_country = {
			limit = {  									#COMPATCH
				capital = {
					OR = {
						region = sr:region_malacca
						region = sr:region_java
						region = sr:region_makasser
						region = sr:region_moluccas
						region = sr:region_philippines					
					}
				}
			}
			save_scope_as = rapanui_friendly_country
		}
		ig:ig_armed_forces = {
			save_scope_as = army_ig
		}
	}

	option = {
		name = rapanui.257.g #Emphasize our peaceful intentions
		default_option = yes
		change_infamy = -3
		scope:rapanui_friendly_country = {
			change_relations = {
				country = ROOT 
				value = 25
			}
		}
	}

	option = {
		name = rapanui.257.h #Praise the commander
		scope:rapanui_friendly_country = {
			change_relations = {
				country = ROOT 
				value = 10
			}
		}
		scope:army_ig = {
			add_modifier = {
				name = lepsius_praised_military_modifier
				years = 3
			}
		}
	}

	after = {
		add_rapanui_pacific_expedition_progress = yes
		sub_rapanui_pacific_expedition_reputation = yes
	}

	weight_multiplier = {
		base = 1
		modifier = {
		  has_variable = rapanui_pe_reputation_var
		  factor = 10
		}
	}
}

#Rapanui 433: National maritime disaster in $COUNTRY$

rapanui.433 = {
	dlc = dlc_morgenrote

	type = country_event

    title = rapanui.433.t
    desc = rapanui.433.d
    flavor = rapanui.415.f

    event_image = {
		texture = "gfx/event_pictures/rapanui_pictures/rapanui_nw_disaster.dds"
	}

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

    duration = 2

	immediate = {
		random_country = {
			limit = {
				has_modifier = rapanui_northwest_disaster_modifier
			}
			save_scope_as = rapanui_franklin_country
		}
		every_country = {
			limit = {
				has_diplomatic_pact = {
					who = scope:rapanui_franklin_country
					type = rivalry
				}
			}
			save_scope_as = rapanui_rival_country
		}
		random_scope_character = {
			limit = {
				has_role = admiral
				is_busy = no
			}
			save_scope_as = rapanui_northwest_expedition_hero
		}
	}

	option = {
		name = rapanui.433.g #Send a telegram expressing our sincere condolences.
		default_option = yes
		scope:rapanui_franklin_country = {
			change_relations = {
				country = ROOT 
				value = 5
			}
		}
	}

	option = {
		name = rapanui.433.h #Whoever seeks danger should perish in danger.
		scope:rapanui_franklin_country = {
			change_relations = {
				country = ROOT 
				value = -5
			}
		}
		scope:rapanui_rival_country = {
			change_relations = {
				country = ROOT 
				value = 5
			}
		}
	}

	option = {
		name = rapanui.415.h #Send a rescue mission!
		trigger = {
			exists = scope:rapanui_northwest_expedition_hero
			any_scope_building = {
				is_building_type = building_port
			}
			any_scope_interest_marker = {								#COMPATCH
				region = sr:region_ruperts_land	
			}
		}
		scope:rapanui_franklin_country = {
			change_relations = {
				country = ROOT 
				value = 10
			}
		}
		add_treasury = -50000
		scope:rapanui_northwest_expedition_hero = {
			set_variable = rapanui_northwest_expedition_hero_var
			set_character_busy_and_immortal = yes
		}
		hidden_effect = {
			random_list = {
				1 = {
					trigger_event = {
						id = rapanui.434 #Rescue mission finds some remains
						days = { 90 120 }
					}
				}
				1 = {
					trigger_event = {
						id = rapanui.435 #Rescue mission does not find anything
						days = { 90 120 }
					}
				}
				1 = {
					trigger_event = {
						id = rapanui.436 #Rescue mission finds ship
						days = { 90 120 }
					}
				}
			}
		}
	}

	after = {
		if = {
			limit = {
				NOT = {
					has_global_variable = rapanui_franklin_var
				}
			}
			every_country = {
				limit = {
					NOT = {
						this = ROOT
					}
					OR = {
						country_rank = rank_value:great_power
						any_scope_interest_marker = {					#COMPATCH
							region = sr:region_ruperts_land
						}
						is_player = yes
					}
				}
				trigger_event = {
					id = rapanui.433 #Notification
					days = { 90 120 }
				}
			}
		}
	}
}
